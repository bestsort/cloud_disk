<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.bestsort.cloud_disk.file.dao.FilesDao">

    <resultMap type="cn.bestsort.cloud_disk.file.entity.Files" id="FilesMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="name" column="name" jdbcType="VARCHAR"/>
        <result property="isDir" column="is_dir" jdbcType="OTHER"/>
        <result property="parentPath" column="parent_path" jdbcType="VARCHAR"/>
        <result property="realPath" column="real_path" jdbcType="VARCHAR"/>
        <result property="size" column="size" jdbcType="INTEGER"/>
        <result property="unit" column="unit" jdbcType="OTHER"/>
        <result property="md5" column="md5" jdbcType="VARCHAR"/>
        <result property="ownerId" column="owner_id" jdbcType="INTEGER"/>
        <result property="userReadLimit" column="user_read_limit" jdbcType="INTEGER"/>
        <result property="userWriteLimit" column="user_write_limit" jdbcType="INTEGER"/>
        <result property="isRemoved" column="is_removed" jdbcType="OTHER"/>
        <result property="gmtCreate" column="gmt_create" jdbcType="TIMESTAMP"/>
        <result property="gmtUpdate" column="gmt_update" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!--查询单个-->
    <select id="queryById" resultMap="FilesMap">
        select
          id, name, is_dir, parent_path, real_path, size, unit, md5, owner_id, user_read_limit, user_write_limit, is_removed, gmt_create, gmt_update
        from bbs_lite.files
        where id = #{id}
    </select>

    <!--查询指定行数据-->
    <select id="queryAllByLimit" resultMap="FilesMap">
        select
          id, name, is_dir, parent_path, real_path, size, unit, md5, owner_id, user_read_limit, user_write_limit, is_removed, gmt_create, gmt_update
        from bbs_lite.files
        limit #{offset}, #{limit}
    </select>

    <!--通过实体作为筛选条件查询-->
    <select id="queryAll" resultMap="FilesMap">
        select
          id, name, is_dir, parent_path, real_path, size, unit, md5, owner_id, user_read_limit, user_write_limit, is_removed, gmt_create, gmt_update
        from bbs_lite.files
        <where>
            <if test="id != null">
                and id = #{id}
            </if>
            <if test="name != null and name != ''">
                and name = #{name}
            </if>
            <if test="isDir != null">
                and is_dir = #{isDir}
            </if>
            <if test="parentPath != null and parentPath != ''">
                and parent_path = #{parentPath}
            </if>
            <if test="realPath != null and realPath != ''">
                and real_path = #{realPath}
            </if>
            <if test="size != null">
                and size = #{size}
            </if>
            <if test="unit != null">
                and unit = #{unit}
            </if>
            <if test="md5 != null and md5 != ''">
                and md5 = #{md5}
            </if>
            <if test="ownerId != null">
                and owner_id = #{ownerId}
            </if>
            <if test="userReadLimit != null">
                and user_read_limit = #{userReadLimit}
            </if>
            <if test="userWriteLimit != null">
                and user_write_limit = #{userWriteLimit}
            </if>
            <if test="isRemoved != null">
                and is_removed = #{isRemoved}
            </if>
            <if test="gmtCreate != null">
                and gmt_create = #{gmtCreate}
            </if>
            <if test="gmtUpdate != null">
                and gmt_update = #{gmtUpdate}
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insert" keyProperty="id" useGeneratedKeys="true">
        insert into bbs_lite.files(name, is_dir, parent_path, real_path, size, unit, md5, owner_id, user_read_limit, user_write_limit, is_removed, gmt_create, gmt_update)
        values (#{name}, #{isDir}, #{parentPath}, #{realPath}, #{size}, #{unit}, #{md5}, #{ownerId}, #{userReadLimit}, #{userWriteLimit}, #{isRemoved}, #{gmtCreate}, #{gmtUpdate})
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update bbs_lite.files
        <set>
            <if test="name != null and name != ''">
                name = #{name},
            </if>
            <if test="isDir != null">
                is_dir = #{isDir},
            </if>
            <if test="parentPath != null and parentPath != ''">
                parent_path = #{parentPath},
            </if>
            <if test="realPath != null and realPath != ''">
                real_path = #{realPath},
            </if>
            <if test="size != null">
                size = #{size},
            </if>
            <if test="unit != null">
                unit = #{unit},
            </if>
            <if test="md5 != null and md5 != ''">
                md5 = #{md5},
            </if>
            <if test="ownerId != null">
                owner_id = #{ownerId},
            </if>
            <if test="userReadLimit != null">
                user_read_limit = #{userReadLimit},
            </if>
            <if test="userWriteLimit != null">
                user_write_limit = #{userWriteLimit},
            </if>
            <if test="isRemoved != null">
                is_removed = #{isRemoved},
            </if>
            <if test="gmtCreate != null">
                gmt_create = #{gmtCreate},
            </if>
            <if test="gmtUpdate != null">
                gmt_update = #{gmtUpdate},
            </if>
        </set>
        where id = #{id}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from bbs_lite.files where id = #{id}
    </delete>

</mapper>